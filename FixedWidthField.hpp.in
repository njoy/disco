#include <type_traits>

#include "utility/TypeSwitch.hpp"

namespace disco{

template< uint16_t w >
struct FixedWidthField {

  /* tag structs */
  struct Trusted{};
  struct NotTrusted{};

  /* convenience typedefs */
  template< typename T >
  using ArgumentType =
    typename utility::TypeSwitch
             < T, typename std::add_const
                           < typename std::add_lvalue_reference
                                      < T >::type >::type,
               std::is_trivially_copyable< T >::value >::type;

  template< bool trust >
  using TrustTag = typename utility::TypeSwitch
                            < Trusted, NotTrusted, trust >::type;

  /* helper methods */
  template< typename Iterator >
  static void
  verifyWidth_( Iterator, Iterator, Trusted ){} 

  template< typename Iterator >
  static void
  verifyWidth_( Iterator begin, Iterator end, NotTrusted ){
    if (  w > std::distance( begin, end ) ){ throw std::exception(); }
  }
  
  constexpr static bool
  isSpace( const char c ){
    return c == ' ' || c == '\t' || c == '\n'
           || c == '\v' || c == '\f' || c == '\r';
  }

#include "disco/FixedWidthField/src/skipPad.hpp"
  
};

}
